# proto/openapi/v1alpha1/schemas/CloudEvent.yaml
#
# Protocol buffer representation of CloudEvents, used to signal that
# various activities have taken place within the daemon or in the
# larger ecosystem, e.g. "app creation", "dataset fork", etc.
#
# {
#     "specversion" : "1.0",
#     "type" : "com.github.pull_request.opened",
#     "source" : "https://github.com/cloudevents/spec/pull",
#     "subject" : "123",
#     "id" : "A234-1234-1234",
#     "time" : "2018-04-05T17:31:00Z",
#     "comexampleextension1" : "value",
#     "comexampleothervalue" : 5,
#     "datacontenttype" : "text/xml",
#     "data" : "<much wow=\"xml\"/>"
# }
#
# TODO "extension attributes"
# TODO "event data" (domain-specific information about the occurrence;
# if present named "data")
---

type: object
description: cloud event
properties:
  ## REQUIRED

  specversion:
    description: |
      [required] The version of the CloudEvents specification which this
      event uses. MUST use a value of "1.0" for the current version of
      the specification.
    type: string

  id:
    description: |
      [required] Identifies the event. Producers MUST ensure that
      "source" + "id" is unique for each distinct event. If a duplicate
      event is sent (due to e.g. network transmission error) it MAY
      reuse the same "id".
    type: string

  source:
    description: |
      [required] Identifies the context in which an event
      happened. Often this includes information such as the type of the
      event source, organization publishing the event, or process that
      produced the event. Exact syntax and semantics are defined by the
      event producer.

      Producer MUST ensure that "source" + "id" is unique for each
      distinct event.

      An application MAY assign a unique "source" to each distinct
      producer, making it easy to produce unique IDs as no other
      producer will have the same source. Application MAY use UUIDs,
      URNs, DNS authorities or an application-specific scheme to create
      unique "source" identifiers.

      An absolute URI is RECOMMENDED.
    type: URI

  type:
    description: |
      [required] A value describing the type of event related to the
      originating occurrence. Format is producer defined and might
      include information such as the version of the "type".

      SHOULD be prefixed with a reverse-DNS name indicating the
      organization which defines the semantics of this event type.
    type: string

  ## OPTIONAL

  datacontenttype:
    description: |
      [optional] FIXME
    type: MediaType

  dataschema:
    description: |
      [optional] FIXME
    type: URI

  subject:
    description: |
      [optional] The subject of the event in the context of the event
      producer.
    type: string

  time:
    description: |
      [optional] Timestamp of when the occurrence happened. If present,
      MUST adhere to time format specified in RFC 3339. NB: gRPC
      "timestamp" time adheres to this requirement.
    type: date-time
    format: RFC3339
